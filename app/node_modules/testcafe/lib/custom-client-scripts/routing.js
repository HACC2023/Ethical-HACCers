"use strict";
var __importDefault = (this && this.__importDefault) || function (mod) {
    return (mod && mod.__esModule) ? mod : { "default": mod };
};
Object.defineProperty(exports, "__esModule", { value: true });
exports.unRegister = exports.register = exports.isLegacyTest = void 0;
const get_code_1 = __importDefault(require("./get-code"));
const content_types_1 = __importDefault(require("../assets/content-types"));
function isLegacyTest(test) {
    return !!test.isLegacy;
}
exports.isLegacyTest = isLegacyTest;
function register({ proxy, test, nativeAutomation, folderName }) {
    const routes = [];
    if (isLegacyTest(test))
        return routes;
    test.clientScripts.forEach((script) => {
        const route = script.getResultUrl(folderName);
        proxy.GET(route, {
            content: (0, get_code_1.default)(script, nativeAutomation),
            contentType: content_types_1.default.javascript,
        });
        routes.push(route);
    });
    return routes;
}
exports.register = register;
function unRegister(proxy, routes) {
    routes.forEach(route => {
        proxy.unRegisterRoute(route, 'GET');
    });
}
exports.unRegister = unRegister;
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoicm91dGluZy5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzIjpbIi4uLy4uL3NyYy9jdXN0b20tY2xpZW50LXNjcmlwdHMvcm91dGluZy50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiOzs7Ozs7QUFBQSwwREFBbUQ7QUFDbkQsNEVBQW9EO0FBc0JwRCxTQUFnQixZQUFZLENBQUUsSUFBYztJQUN4QyxPQUFPLENBQUMsQ0FBRSxJQUFtQixDQUFDLFFBQVEsQ0FBQztBQUMzQyxDQUFDO0FBRkQsb0NBRUM7QUFFRCxTQUFnQixRQUFRLENBQUUsRUFBRSxLQUFLLEVBQUUsSUFBSSxFQUFFLGdCQUFnQixFQUFFLFVBQVUsRUFBNkI7SUFDOUYsTUFBTSxNQUFNLEdBQWEsRUFBRSxDQUFDO0lBRTVCLElBQUksWUFBWSxDQUFDLElBQUksQ0FBQztRQUNsQixPQUFPLE1BQU0sQ0FBQztJQUVsQixJQUFJLENBQUMsYUFBYSxDQUFDLE9BQU8sQ0FBQyxDQUFDLE1BQXdCLEVBQUUsRUFBRTtRQUNwRCxNQUFNLEtBQUssR0FBSSxNQUF1QixDQUFDLFlBQVksQ0FBQyxVQUFVLENBQUMsQ0FBQztRQUVoRSxLQUFLLENBQUMsR0FBRyxDQUFDLEtBQUssRUFBRTtZQUNiLE9BQU8sRUFBTSxJQUFBLGtCQUF5QixFQUFDLE1BQXNCLEVBQUUsZ0JBQWdCLENBQUM7WUFDaEYsV0FBVyxFQUFFLHVCQUFhLENBQUMsVUFBVTtTQUN4QyxDQUFDLENBQUM7UUFFSCxNQUFNLENBQUMsSUFBSSxDQUFDLEtBQUssQ0FBQyxDQUFDO0lBQ3ZCLENBQUMsQ0FBQyxDQUFDO0lBRUgsT0FBTyxNQUFNLENBQUM7QUFDbEIsQ0FBQztBQWxCRCw0QkFrQkM7QUFFRCxTQUFnQixVQUFVLENBQUUsS0FBWSxFQUFFLE1BQWdCO0lBQ3RELE1BQU0sQ0FBQyxPQUFPLENBQUMsS0FBSyxDQUFDLEVBQUU7UUFDbkIsS0FBSyxDQUFDLGVBQWUsQ0FBQyxLQUFLLEVBQUUsS0FBSyxDQUFDLENBQUM7SUFDeEMsQ0FBQyxDQUFDLENBQUM7QUFDUCxDQUFDO0FBSkQsZ0NBSUMiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgZ2V0Q3VzdG9tQ2xpZW50U2NyaXB0Q29kZSBmcm9tICcuL2dldC1jb2RlJztcbmltcG9ydCBDT05URU5UX1RZUEVTIGZyb20gJy4uL2Fzc2V0cy9jb250ZW50LXR5cGVzJztcbmltcG9ydCBDbGllbnRTY3JpcHQgZnJvbSAnLi9jbGllbnQtc2NyaXB0JztcbmltcG9ydCB7IFByb3h5IH0gZnJvbSAndGVzdGNhZmUtaGFtbWVyaGVhZCc7XG5pbXBvcnQgQ2xpZW50U2NyaXB0SW5pdCBmcm9tICcuL2NsaWVudC1zY3JpcHQtaW5pdCc7XG5cbmludGVyZmFjZSBUZXN0IHtcbiAgICBjbGllbnRTY3JpcHRzOiBDbGllbnRTY3JpcHRJbml0W107XG59XG5cbmludGVyZmFjZSBMZWdhY3lUZXN0IHtcbiAgICBpc0xlZ2FjeTogYm9vbGVhbjtcbn1cblxudHlwZSBUZXN0SXRlbSA9IFRlc3QgfCBMZWdhY3lUZXN0O1xuXG5pbnRlcmZhY2UgUmVnaXN0ZXJDbGllbnRTY3JpcHRzSW5mbyB7XG4gICAgcHJveHk6IFByb3h5O1xuICAgIHRlc3Q6IFRlc3Q7XG4gICAgbmF0aXZlQXV0b21hdGlvbjogYm9vbGVhbjtcbiAgICBmb2xkZXJOYW1lOiBzdHJpbmc7XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBpc0xlZ2FjeVRlc3QgKHRlc3Q6IFRlc3RJdGVtKTogdGVzdCBpcyBMZWdhY3lUZXN0IHtcbiAgICByZXR1cm4gISEodGVzdCBhcyBMZWdhY3lUZXN0KS5pc0xlZ2FjeTtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIHJlZ2lzdGVyICh7IHByb3h5LCB0ZXN0LCBuYXRpdmVBdXRvbWF0aW9uLCBmb2xkZXJOYW1lIH06IFJlZ2lzdGVyQ2xpZW50U2NyaXB0c0luZm8pOiBzdHJpbmdbXSB7XG4gICAgY29uc3Qgcm91dGVzOiBzdHJpbmdbXSA9IFtdO1xuXG4gICAgaWYgKGlzTGVnYWN5VGVzdCh0ZXN0KSlcbiAgICAgICAgcmV0dXJuIHJvdXRlcztcblxuICAgIHRlc3QuY2xpZW50U2NyaXB0cy5mb3JFYWNoKChzY3JpcHQ6IENsaWVudFNjcmlwdEluaXQpID0+IHtcbiAgICAgICAgY29uc3Qgcm91dGUgPSAoc2NyaXB0IGFzIENsaWVudFNjcmlwdCkuZ2V0UmVzdWx0VXJsKGZvbGRlck5hbWUpO1xuXG4gICAgICAgIHByb3h5LkdFVChyb3V0ZSwge1xuICAgICAgICAgICAgY29udGVudDogICAgIGdldEN1c3RvbUNsaWVudFNjcmlwdENvZGUoc2NyaXB0IGFzIENsaWVudFNjcmlwdCwgbmF0aXZlQXV0b21hdGlvbiksXG4gICAgICAgICAgICBjb250ZW50VHlwZTogQ09OVEVOVF9UWVBFUy5qYXZhc2NyaXB0LFxuICAgICAgICB9KTtcblxuICAgICAgICByb3V0ZXMucHVzaChyb3V0ZSk7XG4gICAgfSk7XG5cbiAgICByZXR1cm4gcm91dGVzO1xufVxuXG5leHBvcnQgZnVuY3Rpb24gdW5SZWdpc3RlciAocHJveHk6IFByb3h5LCByb3V0ZXM6IHN0cmluZ1tdKTogdm9pZCB7XG4gICAgcm91dGVzLmZvckVhY2gocm91dGUgPT4ge1xuICAgICAgICBwcm94eS51blJlZ2lzdGVyUm91dGUocm91dGUsICdHRVQnKTtcbiAgICB9KTtcbn1cbiJdfQ==