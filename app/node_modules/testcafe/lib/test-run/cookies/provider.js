"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.ProxyCookieProvider = void 0;
const base_1 = require("./base");
const lodash_1 = require("lodash");
class ProxyCookieProvider extends base_1.CookieProviderBase {
    async getCookies(externalCookies, urls) {
        const session = this.testRun.session;
        return session.cookies.getCookies(externalCookies, urls);
    }
    async setCookies(cookies, url) {
        const cookiesArray = (0, lodash_1.castArray)(cookies);
        const session = this.testRun.session;
        if (this._isCookieOptionsArray(cookiesArray))
            return session.cookies.setCookies(cookiesArray, url);
        return session.cookies.copySyncCookies(cookiesArray.join(';'), url);
    }
    async deleteCookies(cookies, urls) {
        const session = this.testRun.session;
        return session.cookies.deleteCookies(cookies, urls);
    }
    async getCookieHeader(url, hostname) {
        return this.testRun.session.cookies.getHeader({ url, hostname });
    }
}
exports.ProxyCookieProvider = ProxyCookieProvider;
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoicHJvdmlkZXIuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyIuLi8uLi8uLi9zcmMvdGVzdC1ydW4vY29va2llcy9wcm92aWRlci50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiOzs7QUFFQSxpQ0FBNEQ7QUFDNUQsbUNBQW1DO0FBRW5DLE1BQWEsbUJBQW9CLFNBQVEseUJBQWtCO0lBQ3ZELEtBQUssQ0FBQyxVQUFVLENBQUUsZUFBa0MsRUFBRSxJQUFjO1FBQ2hFLE1BQU0sT0FBTyxHQUFHLElBQUksQ0FBQyxPQUFPLENBQUMsT0FBTyxDQUFDO1FBRXJDLE9BQU8sT0FBTyxDQUFDLE9BQU8sQ0FBQyxVQUFVLENBQUMsZUFBZSxFQUFFLElBQUksQ0FBQyxDQUFDO0lBQzdELENBQUM7SUFFRCxLQUFLLENBQUMsVUFBVSxDQUFFLE9BQTRDLEVBQUUsR0FBVztRQUN2RSxNQUFNLFlBQVksR0FBRyxJQUFBLGtCQUFTLEVBQXlCLE9BQU8sQ0FBQyxDQUFDO1FBQ2hFLE1BQU0sT0FBTyxHQUFRLElBQUksQ0FBQyxPQUFPLENBQUMsT0FBTyxDQUFDO1FBRTFDLElBQUksSUFBSSxDQUFDLHFCQUFxQixDQUFDLFlBQVksQ0FBQztZQUN4QyxPQUFPLE9BQU8sQ0FBQyxPQUFPLENBQUMsVUFBVSxDQUFDLFlBQVksRUFBRSxHQUFHLENBQUMsQ0FBQztRQUV6RCxPQUFPLE9BQU8sQ0FBQyxPQUFPLENBQUMsZUFBZSxDQUFDLFlBQVksQ0FBQyxJQUFJLENBQUMsR0FBRyxDQUFDLEVBQUUsR0FBRyxDQUFDLENBQUM7SUFDeEUsQ0FBQztJQUVELEtBQUssQ0FBQyxhQUFhLENBQUUsT0FBd0IsRUFBRSxJQUFjO1FBQ3pELE1BQU0sT0FBTyxHQUFHLElBQUksQ0FBQyxPQUFPLENBQUMsT0FBTyxDQUFDO1FBRXJDLE9BQU8sT0FBTyxDQUFDLE9BQU8sQ0FBQyxhQUFhLENBQUMsT0FBTyxFQUFFLElBQUksQ0FBQyxDQUFDO0lBQ3hELENBQUM7SUFFRCxLQUFLLENBQUMsZUFBZSxDQUFFLEdBQVcsRUFBRSxRQUFnQjtRQUNoRCxPQUFPLElBQUksQ0FBQyxPQUFPLENBQUMsT0FBTyxDQUFDLE9BQU8sQ0FBQyxTQUFTLENBQUMsRUFBRSxHQUFHLEVBQUUsUUFBUSxFQUFFLENBQUMsQ0FBQztJQUNyRSxDQUFDO0NBQ0o7QUExQkQsa0RBMEJDIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgRXh0ZXJuYWxDb29raWVzIH0gZnJvbSAndGVzdGNhZmUtaGFtbWVyaGVhZCc7XG5pbXBvcnQgeyBDb29raWVPcHRpb25zIH0gZnJvbSAnLi4vY29tbWFuZHMvb3B0aW9ucyc7XG5pbXBvcnQgeyBDb29raWVQcm92aWRlciwgQ29va2llUHJvdmlkZXJCYXNlIH0gZnJvbSAnLi9iYXNlJztcbmltcG9ydCB7IGNhc3RBcnJheSB9IGZyb20gJ2xvZGFzaCc7XG5cbmV4cG9ydCBjbGFzcyBQcm94eUNvb2tpZVByb3ZpZGVyIGV4dGVuZHMgQ29va2llUHJvdmlkZXJCYXNlIGltcGxlbWVudHMgQ29va2llUHJvdmlkZXIge1xuICAgIGFzeW5jIGdldENvb2tpZXMgKGV4dGVybmFsQ29va2llczogRXh0ZXJuYWxDb29raWVzW10sIHVybHM6IHN0cmluZ1tdKTogUHJvbWlzZTxFeHRlcm5hbENvb2tpZXNbXT4ge1xuICAgICAgICBjb25zdCBzZXNzaW9uID0gdGhpcy50ZXN0UnVuLnNlc3Npb247XG5cbiAgICAgICAgcmV0dXJuIHNlc3Npb24uY29va2llcy5nZXRDb29raWVzKGV4dGVybmFsQ29va2llcywgdXJscyk7XG4gICAgfVxuXG4gICAgYXN5bmMgc2V0Q29va2llcyAoY29va2llczogc3RyaW5nIHwgc3RyaW5nW10gfCBDb29raWVPcHRpb25zW10sIHVybDogc3RyaW5nKTogUHJvbWlzZTx2b2lkPiB7XG4gICAgICAgIGNvbnN0IGNvb2tpZXNBcnJheSA9IGNhc3RBcnJheTxzdHJpbmcgfCBDb29raWVPcHRpb25zPihjb29raWVzKTtcbiAgICAgICAgY29uc3Qgc2Vzc2lvbiAgICAgID0gdGhpcy50ZXN0UnVuLnNlc3Npb247XG5cbiAgICAgICAgaWYgKHRoaXMuX2lzQ29va2llT3B0aW9uc0FycmF5KGNvb2tpZXNBcnJheSkpXG4gICAgICAgICAgICByZXR1cm4gc2Vzc2lvbi5jb29raWVzLnNldENvb2tpZXMoY29va2llc0FycmF5LCB1cmwpO1xuXG4gICAgICAgIHJldHVybiBzZXNzaW9uLmNvb2tpZXMuY29weVN5bmNDb29raWVzKGNvb2tpZXNBcnJheS5qb2luKCc7JyksIHVybCk7XG4gICAgfVxuXG4gICAgYXN5bmMgZGVsZXRlQ29va2llcyAoY29va2llczogQ29va2llT3B0aW9uc1tdLCB1cmxzOiBzdHJpbmdbXSk6IFByb21pc2U8dm9pZD4ge1xuICAgICAgICBjb25zdCBzZXNzaW9uID0gdGhpcy50ZXN0UnVuLnNlc3Npb247XG5cbiAgICAgICAgcmV0dXJuIHNlc3Npb24uY29va2llcy5kZWxldGVDb29raWVzKGNvb2tpZXMsIHVybHMpO1xuICAgIH1cblxuICAgIGFzeW5jIGdldENvb2tpZUhlYWRlciAodXJsOiBzdHJpbmcsIGhvc3RuYW1lOiBzdHJpbmcpOiBQcm9taXNlPHN0cmluZyB8IG51bGw+IHtcbiAgICAgICAgcmV0dXJuIHRoaXMudGVzdFJ1bi5zZXNzaW9uLmNvb2tpZXMuZ2V0SGVhZGVyKHsgdXJsLCBob3N0bmFtZSB9KTtcbiAgICB9XG59XG4iXX0=